<div class="px-6 py-10 pt-28">
<div class="max-w-5xl mx-auto" x-data="{ search: '' }">

  <div class="mb-8 bg-white rounded-xl shadow-lg p-6">
    <div class="mb-4">
      <a href="/minggu/{{pertemuan.minggu.id}}" 
         class="inline-flex items-center text-gray-700 text-base font-semibold hover:underline">
        <svg xmlns="http://www.w3.org/2000/svg" 
             class="h-5 w-5 mr-1" fill="none" 
             viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" 
                stroke-linejoin="round" 
                stroke-width="2" 
                d="M15 19l-7-7 7-7" />
        </svg>
        Back
      </a>
    </div>  

    <div class="flex items-start justify-between">
      <div>
        <h1 class="text-3xl font-bold mb-2 text-gray-900">Session {{pertemuan.pertemuan_ke}}</h1>

        <p class="text-gray-600 mb-1">
          <span class="font-semibold">Class:</span> {{pertemuan.minggu.kelas.nama_kelas}}
        </p>
        <p class="text-gray-600 mb-1">
          <span class="font-semibold">Location:</span> {{pertemuan.lokasi}}
        </p class="text-gray-600">
        <p class="text-gray-600 mb-1">
          <span class="font-semibold">Topic:</span> {{pertemuan.topik}}
        </p>
        <p class="text-gray-600 mb-1">
          <span class="font-semibold">Date:</span> {{formatTanggal pertemuan.tanggal}}
        </p>
        <p class="text-gray-600 mb-1">
          <span class="font-semibold">Time :</span> {{formatTime pertemuan.waktu_awal}} - {{formatTime pertemuan.waktu_akhir}}
        </p>

      </div>

<div class="flex items-center gap-4">
  <!-- Tombol Edit -->
  <a href="/pertemuans/formEdit/{{pertemuan.id}}"
     class="p-3 rounded-xl bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-800 transition shadow-sm"
     title="Edit Pertemuan">
    <!-- Icon Edit (Pencil) -->
    <svg xmlns="http://www.w3.org/2000/svg"
         fill="none" viewBox="0 0 24 24"
         stroke-width="2" stroke="currentColor"
         class="w-7 h-7">
      <path stroke-linecap="round" stroke-linejoin="round"
            d="M16.862 4.487l1.687-1.688a1.875 1.875 
               0 112.652 2.652L10.582 16.07a4.5 
               4.5 0 01-1.897 1.13l-2.685.805.805-2.685
               a4.5 4.5 0 011.13-1.897l10.927-10.936z" />
      <path stroke-linecap="round" stroke-linejoin="round"
            d="M19.5 7.125L16.875 4.5" />
    </svg>
  </a>

  <!-- Tombol Delete -->
  <form action="/pertemuans/{{pertemuan.id}}/{{pertemuan.minggu.id}}?_method=DELETE" method="post">
    <button 
      type="button"
      onclick="confirmDelete(this)"
      class="p-3 rounded-xl bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-800 transition shadow-sm"
      title="Delete Pertemuan">
      <!-- Icon Delete (X / Trash) -->
      <svg xmlns="http://www.w3.org/2000/svg"
           fill="none" viewBox="0 0 24 24"
           stroke-width="2" stroke="currentColor"
           class="w-7 h-7">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </form>
</div>

    </div>
  </div>
</div>


<div class="max-w-5xl mx-auto" x-data="{ tab: 'absen', search: '' }">

    <div class="flex space-x-4 mb-6">
    <button @click="tab = 'absen'" 
            :class="tab === 'absen' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
            class="px-4 py-2 rounded-lg shadow transition">
      Attendance
    </button>
    <button @click="tab = 'materi'" 
            :class="tab === 'materi' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
            class="px-4 py-2 rounded-lg shadow transition">
      Materi
    </button>
    <button @click="tab = 'tugas'" 
            :class="tab === 'tugas' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
            class="px-4 py-2 rounded-lg shadow transition">
      Assignment
    </button>
    <button @click="tab = 'logbook'" 
            :class="tab === 'logbook' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
            class="px-4 py-2 rounded-lg shadow transition">
      Log book user
    </button>
    <button @click="tab = 'logbook_mentor'" 
            :class="tab === 'logbook_mentor' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
            class="px-4 py-2 rounded-lg shadow transition">
      Log book mentor
    </button>
  </div>

  <div x-show="tab === 'logbook'">
<div class="max-w-5xl mx-auto " 
     x-data="logbookTable({ logbooks: {{json logbook}} })">
  
  <div class="mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4">

    <div class="flex items-center gap-3">
      <div class="relative w-full md:w-64">
        <input 
          type="text" 
          placeholder="Search logbook..." 
          x-model="searchInput"
          @input="search = searchInput; pageNumber=0"
          class="border border-gray-300 bg-white text-gray-900 rounded-lg px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-gray-900 w-full"
        />
        <button 
          @click="search = searchInput; pageNumber=0"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-900"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z"/>
          </svg>
        </button>
      </div>

      <a href="/logbook/formCreate" 
         class="bg-gray-900 text-white px-4 py-2 rounded-lg shadow hover:bg-gray-600 transition">
        Create Logbook
      </a>

      <!-- DIPERBAIKI: Panggil method dari Alpine component -->
<button 
  @click="exportExcel()" 
  class="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg shadow hover:bg-green-700 transition"
>
  <!-- Logo Excel dengan shadow lebih tebal -->
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="h-5 w-5 rounded shadow">
    <path fill="#185C37" d="M42 6H14a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h28a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2z"/>
    <path fill="#21A366" d="M14 6H8a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h6V6z"/>
    <path fill="#107C41" d="M22 14H8v20h14V14z"/>
    <path fill="#fff" d="M19 31h-2.1l-2.9-5-2.9 5H9l4.2-7-4.1-7h2.1l2.9 5 2.9-5H19l-4.2 7 4.2 7z"/>
  </svg>
  Export Excel
</button>


    </div>
  </div>

  <div class="overflow-x-auto bg-white shadow-lg rounded-xl">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">No</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Kegiatan</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Rincian</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Kendala</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Dokumentasi</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Kelas</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">User</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">status</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Action</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        {{#each logbook}}
        <tr class="hover:bg-gray-50 transition"
            x-show="filteredLogbooks.includes('{{id}}')">
          <td class="px-6 py-4 text-sm text-gray-800">{{addOne @index}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{kegiatan}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{rincian_kegiatan}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{kendala}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">
            <img src="{{dokumentasi}}" alt="Dokumentasi" class="w-16 h-16 object-cover rounded border" />
          </td>
          <td class="px-6 py-4 text-sm text-gray-800">{{kelas.nama_kelas}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{user.username}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{proses}}</td>
<td class="px-6 py-4 text-sm text-gray-800">
  <div class="flex items-center justify-center gap-2">
    <!-- ACC Button -->
    <form action="/logbook/{{id}}/acc?_method=PATCH" method="post" class="inline">
      <button type="submit" 
              class="p-2 rounded-full bg-green-500 text-white hover:bg-green-600 transition">
        <!-- Check Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" 
             class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
      </button>
    </form>

    <!-- Reject Button -->
    <form action="/logbook/{{id}}/rejected?_method=PATCH" method="post" class="inline">
      <button type="submit" 
              class="p-2 rounded-full bg-red-500 text-white hover:bg-red-600 transition">
        <!-- X Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" 
             class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </form>
  </div>
</td>

        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>

  <div class="w-full md:w-1/2 mx-auto py-6 flex justify-center gap-2 items-center" 
       x-show="pageCount() > 1">
    <button @click="prevPage" :disabled="pageNumber==0"
      class="px-3 py-1 rounded border border-gray-900 text-gray-900"
      :class="{ 'opacity-50 cursor-not-allowed': pageNumber==0 }">Prev</button>

    <template x-for="(page,index) in pages()" :key="index">
      <button @click="viewPage(index)" 
        class="px-3 py-1 rounded"
        :class="{ 'bg-gray-900 text-white font-bold': index===pageNumber }"
        x-text="index+1"></button>
    </template>

    <button @click="nextPage" :disabled="pageNumber >= pageCount()-1"
      class="px-3 py-1 rounded border border-gray-900 text-gray-900"
      :class="{ 'opacity-50 cursor-not-allowed': pageNumber >= pageCount()-1 }">Next</button>
  </div>
</div>

<script>
// DIPERBAIKI: Pindahkan exportExcel ke dalam Alpine component
function logbookTable({ logbooks }) {
  return {
    searchInput: "",
    search: "",
    pageNumber: 0,
    size: 5,
    logbooks,
    amount: 0,
    
    get filteredLogbooks() {
      let filtered = this.logbooks.filter(l =>
        (`${l.kegiatan} ${l.rincian_kegiatan} ${l.kendala}`).toLowerCase()
          .includes(this.search.toLowerCase())
      );

      this.amount = filtered.length;

      const start = this.pageNumber * this.size;
      const end = start + this.size;
      return filtered.slice(start, end).map(l => l.id.toString());
    },
    
    // DIPERBAIKI: Export Excel sesuai data yang tampil di table
    exportExcel() {
      // Ambil data yang sudah difilter
      const filtered = this.logbooks.filter(l =>
        (`${l.kegiatan} ${l.rincian_kegiatan} ${l.kendala}`).toLowerCase()
          .includes(this.search.toLowerCase())
      );

      // Ambil data sesuai halaman yang sedang aktif
      const start = this.pageNumber * this.size;
      const end = start + this.size;
      const currentPageData = filtered.slice(start, end);

      const rows = [
        ["No", "Kegiatan", "Rincian", "Kendala", "dokumentasi", "User", "Kelas", "Created At"]
      ];

      currentPageData.forEach((l, index) => {
        rows.push([
          start + index + 1, // Nomor urut sesuai halaman
          l.kegiatan,
          l.rincian_kegiatan,
          l.kendala,
          l.dokumentasi,
          l.user?.username ?? "-",
          l.kelas?.nama_kelas ?? "-",
          l.createdAt
        ]);
      });

      const worksheet = XLSX.utils.aoa_to_sheet(rows);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Logbook");

      XLSX.writeFile(workbook, "logbook.xlsx");
    },

    pages() { return Array.from({ length: this.pageCount() }); },
    pageCount() { return Math.ceil(this.amount / this.size); },
    nextPage() { if (this.pageNumber < this.pageCount()-1) this.pageNumber++; },
    prevPage() { if (this.pageNumber > 0) this.pageNumber--; },
    viewPage(index) { this.pageNumber = index; }
  }
}

// HAPUS: Fungsi exportExcel yang lama sudah tidak diperlukan
// function exportExcel() { ... }
</script>
  </div>

  <div x-show="tab === 'logbook_mentor'">
<div class="max-w-5xl mx-auto " 
     x-data="logbookTable({ logbooks: {{json logbook_mentor}} })">
  
  <div class="mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4">

    <div class="flex items-center gap-3">
      <div class="relative w-full md:w-64">
        <input 
          type="text" 
          placeholder="Search logbook..." 
          x-model="searchInput"
          @input="search = searchInput; pageNumber=0"
          class="border border-gray-300 bg-white text-gray-900 rounded-lg px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-gray-900 w-full"
        />
        <button 
          @click="search = searchInput; pageNumber=0"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-900"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z"/>
          </svg>
        </button>
      </div>

      <a href="/logbook-mentor/formCreate/{{pertemuan.id}}" 
         class="bg-gray-900 text-white px-4 py-2 rounded-lg shadow hover:bg-gray-600 transition">
        Create Logbook
      </a>

      <!-- DIPERBAIKI: Panggil method dari Alpine component -->
<button 
  @click="exportExcel()" 
  class="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg shadow hover:bg-green-700 transition"
>
  <!-- Logo Excel dengan shadow lebih tebal -->
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="h-5 w-5 rounded shadow">
    <path fill="#185C37" d="M42 6H14a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h28a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2z"/>
    <path fill="#21A366" d="M14 6H8a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h6V6z"/>
    <path fill="#107C41" d="M22 14H8v20h14V14z"/>
    <path fill="#fff" d="M19 31h-2.1l-2.9-5-2.9 5H9l4.2-7-4.1-7h2.1l2.9 5 2.9-5H19l-4.2 7 4.2 7z"/>
  </svg>
  Export Excel
</button>


    </div>
  </div>

  <div class="overflow-x-auto bg-white shadow-lg rounded-xl">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">No</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Kegiatan</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Rincian</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Kendala</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Dokumentasi</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Kelas</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">User</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Action</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        {{#each logbook_mentor}}
        <tr class="hover:bg-gray-50 transition"
            x-show="filteredLogbooks.includes('{{id}}')">
          <td class="px-6 py-4 text-sm text-gray-800">{{addOne @index}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{kegiatan}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{rincian_kegiatan}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{kendala}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">
            <img src="{{dokumentasi}}" alt="Dokumentasi" class="w-16 h-16 object-cover rounded border" />
          </td>
          <td class="px-6 py-4 text-sm text-gray-800">{{kelas.nama_kelas}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{user.username}}</td>
<td class="px-6 py-4 text-sm text-gray-800">
  <div class="flex items-center justify-center gap-2">
    <a href="/logbook-mentor/{{id}}" 
       class="p-2 rounded-full bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:text-indigo-800 transition" 
       title="View Kelas">
      <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M12 6.75c-4.5 0-8.25 2.25-10.5 6 
                 2.25 3.75 6 6 10.5 6s8.25-2.25 
                 10.5-6c-2.25-3.75-6-6-10.5-6z" />
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M12 15a3 3 0 100-6 3 3 0 000 6z" />
      </svg>
    </a>
  </div>
</td>

        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>

  <div class="w-full md:w-1/2 mx-auto py-6 flex justify-center gap-2 items-center" 
       x-show="pageCount() > 1">
    <button @click="prevPage" :disabled="pageNumber==0"
      class="px-3 py-1 rounded border border-gray-900 text-gray-900"
      :class="{ 'opacity-50 cursor-not-allowed': pageNumber==0 }">Prev</button>

    <template x-for="(page,index) in pages()" :key="index">
      <button @click="viewPage(index)" 
        class="px-3 py-1 rounded"
        :class="{ 'bg-gray-900 text-white font-bold': index===pageNumber }"
        x-text="index+1"></button>
    </template>

    <button @click="nextPage" :disabled="pageNumber >= pageCount()-1"
      class="px-3 py-1 rounded border border-gray-900 text-gray-900"
      :class="{ 'opacity-50 cursor-not-allowed': pageNumber >= pageCount()-1 }">Next</button>
  </div>
</div>

<script>
// DIPERBAIKI: Pindahkan exportExcel ke dalam Alpine component
function logbookTable({ logbooks }) {
  return {
    searchInput: "",
    search: "",
    pageNumber: 0,
    size: 5,
    logbooks,
    amount: 0,
    
    get filteredLogbooks() {
      let filtered = this.logbooks.filter(l =>
        (`${l.kegiatan} ${l.rincian_kegiatan} ${l.kendala}`).toLowerCase()
          .includes(this.search.toLowerCase())
      );

      this.amount = filtered.length;

      const start = this.pageNumber * this.size;
      const end = start + this.size;
      return filtered.slice(start, end).map(l => l.id.toString());
    },
    
    // DIPERBAIKI: Export Excel sesuai data yang tampil di table
    exportExcel() {
      // Ambil data yang sudah difilter
      const filtered = this.logbooks.filter(l =>
        (`${l.kegiatan} ${l.rincian_kegiatan} ${l.kendala}`).toLowerCase()
          .includes(this.search.toLowerCase())
      );

      // Ambil data sesuai halaman yang sedang aktif
      const start = this.pageNumber * this.size;
      const end = start + this.size;
      const currentPageData = filtered.slice(start, end);

      const rows = [
        ["No", "Kegiatan", "Rincian", "Kendala", "dokumentasi", "User", "Kelas", "Created At"]
      ];

      currentPageData.forEach((l, index) => {
        rows.push([
          start + index + 1, // Nomor urut sesuai halaman
          l.kegiatan,
          l.rincian_kegiatan,
          l.kendala,
          l.dokumentasi,
          l.user?.username ?? "-",
          l.kelas?.nama_kelas ?? "-",
          l.createdAt
        ]);
      });

      const worksheet = XLSX.utils.aoa_to_sheet(rows);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Logbook");

      XLSX.writeFile(workbook, "logbook.xlsx");
    },

    pages() { return Array.from({ length: this.pageCount() }); },
    pageCount() { return Math.ceil(this.amount / this.size); },
    nextPage() { if (this.pageNumber < this.pageCount()-1) this.pageNumber++; },
    prevPage() { if (this.pageNumber > 0) this.pageNumber--; },
    viewPage(index) { this.pageNumber = index; }
  }
}

// HAPUS: Fungsi exportExcel yang lama sudah tidak diperlukan
// function exportExcel() { ... }
</script>
  </div>

  <div x-show="tab === 'absen'" >
<div 
     x-data="absenTable({ peserta: {{json murid}} })">
  
  <div class="mb-6 flex flex-col md:flex-row md:justify-between md:items-center gap-4">

    <div class="flex items-center gap-3">
      <!-- Search -->
      <div class="relative w-full md:w-64">
        <button 
          @click="search = searchInput; pageNumber=0"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-900"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z"/>
          </svg>
        </button>
        <input 
          type="text" 
          placeholder="Search perticipant..." 
          x-model="searchInput"
          @input="search = searchInput; pageNumber=0"
          class="border border-gray-300 bg-white text-gray-900 rounded-lg px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-gray-900 w-full"
        />
      </div>

      <!-- Tambah Absen -->
      <a href="/absens/create/{{pertemuan.id}}"
         class="bg-gray-900 text-white px-4 py-2 rounded-lg shadow hover:bg-gray-600 transition">
        Create Attendance
      </a>
    </div>
  </div>

  <!-- Table -->
  <div class="overflow-x-auto bg-white shadow-lg rounded-xl">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">No</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Nama</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Email</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Status</th>
          <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Aksi</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        {{#each murid}}
        <tr class="hover:bg-gray-50 transition"
            x-show="filteredPeserta.includes('{{id}}')">
          <td class="px-6 py-4 text-sm text-gray-800">{{addOne @index}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{username}}</td>
          <td class="px-6 py-4 text-sm text-gray-800">{{email}}</td>
          <td class="px-6 py-4 text-sm">
            {{#each absen}}
              <span class="font-medium">{{status}}</span>
            {{/each}}
          </td>
          <td class="px-6 py-4 text-sm text-gray-800 flex items-center gap-3">
            {{#each absen}}

                <form action="/absens/formEdit/{{id}}" method="get">
    <button type="submit" 
            class="p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-800 transition" 
            title="Edit">
      <!-- Pencil Icon -->
      <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 
                 2.652L10.582 16.07a4.5 4.5 0 01-1.897 
                 1.13l-2.685.805.805-2.685a4.5 4.5 
                 0 011.13-1.897l10.927-10.936z" />
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M19.5 7.125L16.875 4.5" />
      </svg>
    </button>
  </form>


              <form action="/absens/{{id}}/{{../../pertemuan.id}}?_method=DELETE" method="post" class="inline">
                <button type="button" 
            onclick="confirmDelete(this)" 
            class="p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-800 transition" 
            title="Delete">      <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M6 18L18 6M6 6l12 12" /></button>
              </form>
            {{/each}}
          </td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="w-full md:w-1/2 mx-auto py-6 flex justify-center gap-2 items-center" 
       x-show="pageCount() > 1">
    <button @click="prevPage" :disabled="pageNumber==0"
      class="px-3 py-1 rounded border border-gray-900 text-gray-900"
      :class="{ 'opacity-50 cursor-not-allowed': pageNumber==0 }">Prev</button>

    <template x-for="(page,index) in pages()" :key="index">
      <button @click="viewPage(index)" 
        class="px-3 py-1 rounded"
        :class="{ 'bg-gray-900 text-white font-bold': index===pageNumber }"
        x-text="index+1"></button>
    </template>

    <button @click="nextPage" :disabled="pageNumber >= pageCount()-1"
      class="px-3 py-1 rounded border border-gray-900 text-gray-900"
      :class="{ 'opacity-50 cursor-not-allowed': pageNumber >= pageCount()-1 }">Next</button>
  </div>
</div>
  </div>

<div x-show="tab === 'materi'">
  <div class="bg-white rounded-xl shadow-lg p-6">
    
    <div x-data="{ tab: 'pdf' }" class="space-y-6">
      <div class="flex space-x-4">
        <button @click="tab = 'pdf'" 
                :class="tab === 'pdf' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
                class="px-4 py-2 rounded-lg shadow transition">PDF</button>
        <button @click="tab = 'video'" 
                :class="tab === 'video' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
                class="px-4 py-2 rounded-lg shadow transition">Video</button>
        <button @click="tab = 'ppt'" 
                :class="tab === 'ppt' ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-700'" 
                class="px-4 py-2 rounded-lg shadow transition">PPT</button>
      </div>

<!-- PDF Section -->
<div x-show="tab === 'pdf'">

  {{#if materipdf.length}}
    <ul class="space-y-2 mb-6">
      {{#each materipdf}}
<li class="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm hover:bg-gray-100 transition">
  <span class="text-gray-800">{{judul}}</span>
  <div class="flex space-x-2">


        <form action="/materis/{{id}}/download" method="get">
    <button type="submit" 
            class="p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-800 transition" 
            title="Edit">
      <!-- Pencil Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M12 6.75c-4.5 0-8.25 2.25-10.5 6 
                 2.25 3.75 6 6 10.5 6s8.25-2.25 
                 10.5-6c-2.25-3.75-6-6-10.5-6z" />
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M12 15a3 3 0 100-6 3 3 0 000 6z" />
      </svg>
    </button>
  </form>


              <form action="/materis/{{id}}/{{../pertemuan.id}}?_method=DELETE" method="post" class="inline">
                <button type="button" 
            onclick="confirmDelete(this)" 
            class="p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-800 transition" 
            title="Delete">      <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M6 18L18 6M6 6l12 12" /></button>
              </form>

  </div>
</li>
      {{/each}}
    </ul>
  {{else}}
    <div class="mb-6 flex flex-col items-center justify-center text-center py-16 bg-gray-50 border border-dashed rounded-lg">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
      </svg>
      <p class="text-gray-600 font-medium">No PDF available</p>
      <p class="text-gray-500 text-sm mt-1">Click <span class="font-semibold">Create PDF</span> to add new material.</p>
    </div>
  {{/if}}
      <a href="/materis/formCreate/pdf/{{pertemuan.id}}" 
     class="flex flex-col items-center justify-center text-center py-12 bg-gray-50 border border-dashed rounded-lg hover:bg-gray-100 transition">
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="h-12 w-12 text-gray-400 mb-3" 
         fill="none" viewBox="0 0 24 24" 
         stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
    </svg>
    <span class="text-gray-600 font-medium">Create PDF</span>
  </a>
</div>

<!-- Video Section -->
<div x-show="tab === 'video'">

  {{#if materivideo.length}}
    <ul class="space-y-2 mb-6">
      {{#each materivideo}}
<li class="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm hover:bg-gray-100 transition">
  <span class="text-gray-800">{{judul}}</span>
  <div class="flex space-x-2">
    <!-- Download -->
    <a href="/materis/{{id}}/download" 
       class="p-2 bg-gray-900 text-white rounded-lg shadow hover:bg-gray-700 transition"
       title="Download">
      ⬇
    </a>

    <!-- Delete -->
    <form action="/materis/{{id}}/{{../pertemuan.id}}?_method=DELETE" method="post" class="inline">
      <button type="button" onclick="confirmDelete(this)"
              class="p-2 bg-red-600 text-white rounded-lg shadow hover:bg-red-700 transition"
              title="Delete">
        ✕
      </button>
    </form>
  </div>
</li>
      {{/each}}
    </ul>
  {{else}}
    <div class="mb-6 flex flex-col items-center justify-center text-center py-16 bg-gray-50 border border-dashed rounded-lg">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
      </svg>
      <p class="text-gray-600 font-medium">No video available</p>
      <p class="text-gray-500 text-sm mt-1">Click <span class="font-semibold">Create Video</span> to add new material.</p>
    </div>
  {{/if}}
        <a href="/materis/formCreate/video/{{pertemuan.id}}" 
     class="flex flex-col items-center justify-center text-center py-12 bg-gray-50 border border-dashed rounded-lg hover:bg-gray-100 transition">
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="h-12 w-12 text-gray-400 mb-3" 
         fill="none" viewBox="0 0 24 24" 
         stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
    </svg>
    <span class="text-gray-600 font-medium">Create Video</span>
  </a>
</div>

<!-- PPT Section -->
<div x-show="tab === 'ppt'">

  {{#if materippt.length}}
    <ul class="space-y-2 mb-6">
      {{#each materippt}}
<li class="flex justify-between items-center bg-gray-50 p-3 rounded-lg shadow-sm hover:bg-gray-100 transition">
  <span class="text-gray-800">{{judul}}</span>
  <div class="flex space-x-2">
    <!-- Download -->
    <a href="/materis/{{id}}/download" 
       class="p-2 bg-gray-900 text-white rounded-lg shadow hover:bg-gray-700 transition"
       title="Download">
      ⬇
    </a>

    <!-- Delete -->
    <form action="/materis/{{id}}/{{../pertemuan.id}}?_method=DELETE" method="post" class="inline">
      <button type="button" onclick="confirmDelete(this)"
              class="p-2 bg-red-600 text-white rounded-lg shadow hover:bg-red-700 transition"
              title="Delete">
        ✕
      </button>
    </form>
  </div>
</li>
      {{/each}}
    </ul>
  {{else}}
    <div class="mb-6 flex flex-col items-center justify-center text-center py-16 bg-gray-50 border border-dashed rounded-lg">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 13h6m-3-3v6m-9 1V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
      </svg>
      <p class="text-gray-600 font-medium">No PPT available</p>
      <p class="text-gray-500 text-sm mt-1">Click <span class="font-semibold">Create PPT</span> to add new material.</p>
    </div>
  {{/if}}
        <a href="/materis/formCreate/ppt/{{pertemuan.id}}" 
     class="flex flex-col items-center justify-center text-center py-12 bg-gray-50 border border-dashed rounded-lg hover:bg-gray-100 transition">
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="h-12 w-12 text-gray-400 mb-3" 
         fill="none" viewBox="0 0 24 24" 
         stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
    </svg>
    <span class="text-gray-600 font-medium">Create PPT</span>
  </a>
</div>

    </div>
  </div>
</div>


<div x-show="tab === 'tugas'">
  <!-- Assignment List Section -->
  {{#if pertemuan.tugas.length}}
    <ul class="space-y-3 mb-6">
      {{#each pertemuan.tugas}}
        <li class="flex justify-between items-center bg-white p-4 rounded-xl shadow hover:shadow-lg transition">
          <!-- Title -->
          <span class="text-gray-800 font-semibold text-lg">{{judul}}</span>

          <!-- Actions -->
          <div class="flex items-center gap-2">

    <form action="/jawaban-tugass/{{id}}" method="get">
    <button type="submit" 
            class="p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 hover:text-blue-800 transition" 
            title="Edit">
      <!-- Pencil Icon -->
                                                <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M12 6.75c-4.5 0-8.25 2.25-10.5 6 
                 2.25 3.75 6 6 10.5 6s8.25-2.25 
                 10.5-6c-2.25-3.75-6-6-10.5-6z" />
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M12 15a3 3 0 100-6 3 3 0 000 6z" />
      </svg>
    </button>
  </form>


              <form action="/tugass/{{id}}/{{../pertemuan.id}}?_method=DELETE" method="post" class="inline">
                <button type="button" 
            onclick="confirmDelete(this)" 
            class="p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-800 transition" 
            title="Delete">      <svg xmlns="http://www.w3.org/2000/svg" 
           fill="none" viewBox="0 0 24 24" 
           stroke-width="1.5" stroke="currentColor" 
           class="w-5 h-5">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M6 18L18 6M6 6l12 12" /></button>
              </form>
          </div>
        </li>
      {{/each}}
    </ul>
  {{else}}
    <!-- Empty State -->
    <div class="flex flex-col items-center justify-center text-center py-16 bg-gray-50 border-2 border-dashed rounded-xl mb-6">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-14 w-14 text-gray-400 mb-4" fill="none"
           viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 
                 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
      </svg>
      <p class="text-gray-700 font-medium text-lg">No assignments yet</p>
      <p class="text-gray-500 text-sm mt-1">
        Click <span class="font-semibold">Add Assignment</span> to create a new one.
      </p>
    </div>
  {{/if}}

  <!-- Add Assignment -->
  <a href="/tugass/formCreate/{{pertemuan.id}}" 
     class="flex flex-col items-center justify-center text-center py-12 bg-gray-50 border-2 border-dashed rounded-xl hover:bg-gray-100 transition">
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="h-12 w-12 text-gray-400 mb-3" 
         fill="none" viewBox="0 0 24 24" 
         stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
    </svg>
    <span class="text-gray-700 font-medium">Add Assignment</span>
  </a>
</div>



</div>
</div>


<script>
function absenTable({ peserta }) {
  return {
    searchInput: "",
    search: "",
    pageNumber: 0,
    size: 5,
    peserta,
    amount: 0,
    get filteredPeserta() {
      let filtered = this.peserta.filter(u =>
        (`${u.username} ${u.email} ${u.status || ''}`).toLowerCase()
          .includes(this.search.toLowerCase())
      );
      this.amount = filtered.length;

      const start = this.pageNumber * this.size;
      const end = start + this.size;
      return filtered.slice(start, end).map(u => u.id.toString());
    },
    pages() { return Array.from({ length: this.pageCount() }); },
    pageCount() { return Math.ceil(this.amount / this.size); },
    nextPage() { if (this.pageNumber < this.pageCount()-1) this.pageNumber++; },
    prevPage() { if (this.pageNumber > 0) this.pageNumber--; },
    viewPage(index) { this.pageNumber = index; },
  }
}
</script>