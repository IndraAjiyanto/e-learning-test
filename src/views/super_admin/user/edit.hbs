<div class="pt-28 py-20">
  <div class="max-w-2xl mx-auto px-6 py-10 bg-white rounded-xl shadow-lg" x-data="{ selectedRole: '{{users.role}}' }">
    <h2 class="text-2xl font-semibold mb-6 text-gray-900">Edit User</h2>

    <form action="/users/super_admin/{{users.id}}?_method=PATCH" method="post" class="space-y-6" enctype="multipart/form-data">

<div 
  x-data="{ 
    previewUrl: null, 
    oldPhoto: '{{#if users.profile}}/uploads/images/profile/{{users.profile}}{{else}}/images/default-avatar.png{{/if}}' 
  }" 
  class="space-y-3"
>
  <label for="profile" class="block text-sm font-medium text-gray-700 mb-1">
    Photos Profile
  </label>

  <!-- Input file -->
  <input 
    type="file" 
    id="profile" 
    name="profile" 
    accept="image/*" 
    x-ref="fileInput"
    class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-gray-900 text-gray-700"
    @change="previewUrl = $event.target.files[0] ? URL.createObjectURL($event.target.files[0]) : null"
  >

  <!-- Tampilkan foto lama atau preview baru -->
  <div class="relative w-32 h-32">
    <img 
      :src="previewUrl ? previewUrl : oldPhoto" 
      alt="Preview Photo" 
      class="w-32 h-32 object-cover rounded-lg border border-gray-300"
    >

    <!-- Tombol hapus foto baru -->
    <template x-if="previewUrl">
      <button 
        type="button" 
        class="absolute -top-2 -right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center shadow hover:bg-red-600"
        @click="previewUrl = null; $refs.fileInput.value = null;">
        &times;
      </button>
    </template>
  </div>
</div>

      <div>
        <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label>
        <input type="text" id="username" name="username" value="{{users.username}}" 
          class="w-full border border-gray-300 bg-white text-gray-900 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-gray-900">
      </div>

      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
        <input type="email" id="email" name="email" value="{{users.email}}" 
          class="w-full border border-gray-300 bg-white text-gray-900 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-gray-900">
      </div>

      <div>
        <label for="role" class="block text-sm font-medium text-gray-700 mb-1">Role</label>
        <select id="role" name="role" x-model="selectedRole"
          class="w-full border border-gray-300 bg-white text-gray-900 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-gray-900">
          <option value="admin" {{#if (roles users.role "admin")}}selected{{/if}}>Admin</option>
          <option value="user" {{#if (roles users.role "user")}}selected{{/if}}>User</option>
          <option value="super_admin" {{#if (roles users.role "super_admin")}}selected{{/if}}>Super Admin</option>
        </select>
      </div>

      <div class="flex space-x-4">
        <button type="submit"
          class="bg-gray-900 text-white px-6 py-2 rounded-lg shadow hover:bg-gray-600 transition focus:outline-none focus:ring-2 focus:ring-gray-900">
          Update
        </button>
        <a href="/users"
          class="bg-white border border-gray-300 text-gray-900 px-6 py-2 rounded-lg shadow hover:bg-gray-100 transition focus:outline-none focus:ring-2 focus:ring-gray-900">
          Cancel
        </a>
      </div>

    </form>
  </div>
</div>
