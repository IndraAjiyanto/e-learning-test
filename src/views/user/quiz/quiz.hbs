<form 
  x-data="quizForm()" 
  @submit.prevent="submitForm"
  class="space-y-6"
>
  {{#each pertanyaan}}
  <div class="p-6 border rounded-xl shadow bg-white">
    <p class="font-medium text-gray-800 mb-4">{{pertanyaan_soal}}</p>

    <div class="space-y-2">
      {{#each jawaban}}
      <label class="flex items-center space-x-3 cursor-pointer">
        <input 
          type="radio" 
          name="q-{{../id}}" 
          value="{{id}}" 
          x-model="answers[{{../id}}]" 
          class="accent-blue-600 w-5 h-5"
        >
        <span class="text-gray-700">{{jawaban}}</span>
      </label>
      {{/each}}
    </div>
  </div>
  {{/each}}

  <div class="flex justify-end pt-4">
    <button 
      type="submit" 
      class="px-6 py-3 bg-gradient-to-r from-gray-900 to-gray-700 text-white rounded-lg"
    >
      Kirim Jawaban
    </button>
  </div>
</form>

<script>
function quizForm() {
  return {
    // state untuk jawaban: { pertanyaanId: jawabanId }
    answers: {},

    async submitForm() {
      const data = Object.entries(this.answers).map(([pertanyaanId, jawabanId]) => ({
        pertanyaanId: Number(pertanyaanId),
        jawabanId: Number(jawabanId),
      }));

      const res = await fetch("/jawaban-users", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ jawabanUser: data })
      });

      const result = await res.json();
      console.log(result);
    }
  }
}
</script>
